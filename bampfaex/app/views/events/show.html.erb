<div class="container-fluid">
  <div class="row">
    <div class="col-md-8">
      <!-- image and description column -->
      <div class="row">
        <div class="col-sm">
          <% @preview_tags = get_resourcespace_event_image_previews(@event.id) %>
            <% unless @preview_tags.nil? %>
            <%= render partial: "/layouts/preview_carousel", locals: {preview_tags: @preview_tags} %>
          <% end %>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-4">
          <!-- title box -->
          <div class="card event-title-box">
              <div class="card-body">

                <h2>
                  <%= @event.display_date %>
                </h2>
                <% unless @event.showtime_one_display.nil? %>
                  <h3>
                    <%= @event.showtime_one_display %>
                  </h3>
                <% end %>

                <% unless @event.showtime_two_display.nil? %>
                  <h3>
                    <%= @event.showtime_two_display %>
                  </h3>
                <% end %>
                <% unless @event.location.nil? %>
                <h3>
                  <%= @event.location %>
                </h3>
                <% end %>
            </div>
          </div>
        </div>
        <div class="col-sm-8">
          <!-- description area -->
          <% unless @event.screening_title.nil? %>
            <h1>
              <%= @event.screening_title %>
            </h1>
          <% end %>
          <% unless @event.description.nil? %>
            <%= @event.description&.html_safe %>
          <% end %>
          <% unless @event.permission.nil? %>
          <h3>Film permission:</h3>
          <p>
            <%= @event.permission %>
          </p>
          <% end %>

          <% unless @event.print_source.nil? %>
          <h3>Print Source</h3>
          <p>
            <%= @event.print_source %>
          </p>
          <% end %>

          <% unless @event.film_runtime.nil? %>
          <h3>Film Runtime:</h3>
          <p>
            <%= @event.film_runtime %>
          </p>
          <% end %>
        </div>
      </div>

    </div>
    <div class="col-md-4">
      <!-- related stuff column -->
      <% films_screened = list_event_relations(event_id: @event.id, target_model: "Work", role: 'film screened') %>
      <% unless films_screened.to_a.empty? %>
      <div class="row">
        <div class="col">
          <h2>Films</h2>
          <%= safe_join(films_screened.map { |w| link_to(w.title, "/works/#{w.id}") }, ", ".html_safe) %>
        </div>
      <% end %>
    </div>
    </div>

      <div class="row">

        <div class="col-sm-7">
          <div class="card">
            <div class="card-body">
            <% films_screened = list_event_relations(event_id: @event.id, target_model: "Work", role: 'film screened') %>
            <% unless films_screened.to_a.empty? %>
                  <h2>Film details</h2>
                    <%= safe_join(films_screened.map { |w| link_to(w.title, "/works/#{w.id}") }, ", ".html_safe) %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-5">
        <% ia_recordings = list_internet_archive_recordings(event_id: @event.id) %>
        <% unless ia_recordings.to_a.empty? %>
        <div class="card">
          <div class="card-body">
            <h2>
              Listen to recordings of this event
              <br>
              <ul class="list-group">
                <%= safe_join(ia_recordings.map {|t| t.html_safe }, "").html_safe %>
              </ul>
            </h2>
          </div>
          </div>
        <% end %>
      </div>
      </div>


      <% guests = list_event_relations(event_id: @event.id, target_model: "Person", role: 'in-person guest') %>
      <% unless guests.to_a.empty? %>
        <p>
          <strong>In-person guests:</strong>
          <%= safe_join(guests.map { |p| link_to(p.display_name, "/people/#{p.id}") }, ", ".html_safe) %>
        </p>
      <% end %>

      <% presenters = list_event_relations(event_id: @event.id, target_model: "Person", role: 'presenter') %>
      <% unless presenters.to_a.empty? %>
        <p>
          <strong>Presented by:</strong>
          <%= safe_join(presenters.map { |p| link_to(p.display_name, "/people/#{p.id}") }, ", ".html_safe) %>
        </p>
      <% end %>

      <% performers = list_event_relations(event_id: @event.id, target_model: "Person", role: 'performer') %>
      <% unless performers.to_a.empty? %>
        <p>
          <strong>Performers:</strong>
          <%= safe_join(performers.map { |p| link_to(p.display_name, "/people/#{p.id}") }, ", ".html_safe) %>
        </p>
      <% end %>
      <!--
      <p>
        <strong>Import row id:</strong>
        <%= @event.import_row_id %>
      </p>
      -->






      <% unless @event.short_description.nil? %>
      <p>
        <strong>Short Description:</strong>
        <%= @event.short_description&.html_safe %>
      </p>
      <% end %>

      <% unless @event.legacy_credit_text.nil? %>
      <p>
        <strong>Legacy credit text:</strong>
        <%= @event.legacy_credit_text&.html_safe %>
      </p>
      <% end %>

      <% unless @event.location.nil? %>
      <p>
        <strong>Location:</strong>
        <%= @event.location %>
      </p>
      <% end %>


    </div>
  </div>


  <%= link_to 'Edit', edit_event_path(@event) %> |
  <%= link_to 'Back', events_path %>

</div>
